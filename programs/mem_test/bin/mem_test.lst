
ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 1





       MCS-51 Family Macro Assembler   A S E M - 5 1   V 1.3
       =====================================================



	Source File:	src/mem_test.asm
	Object File:	bin/mem_test.hex
	List File:	bin/mem_test.lst



 Line  I  Addr  Code            Source

    1:		N      0000		max_rom_address_low equ 00h
    2:		N      0080		max_rom_address_high equ 80h
    3:		N      0080		max_ram_address_high equ 80h
    4:		N      0000		max_ram_address_low equ 00h
    5:
    6:		N	 30	dseg at 30h
    7:	    30	N	 01		dptr_high: ds 1
    8:	    31	N	 01		dptr_low: ds 1
    9:
   10:				cseg
   11:
   12:	  0000	02 00 2B		ljmp main
   13:
   14:		N      0005		rept 5
   15:						ljmp $
   16:						ds 5
   17:					endm
   18+ 1  0003	02 00 03			ljmp $
   19+ 1  0006	N      0005			ds 5
   20+ 1  000B	02 00 0B			ljmp $
   21+ 1  000E	N      0005			ds 5
   22+ 1  0013	02 00 13			ljmp $
   23+ 1  0016	N      0005			ds 5
   24+ 1  001B	02 00 1B			ljmp $
   25+ 1  001E	N      0005			ds 5
   26+ 1  0023	02 00 23			ljmp $
   27+ 1  0026	N      0005			ds 5
   28:
   29:	  002B			main:
   30:
   31:	  002B	75 F0 00		mov b, #00h
   32:
   33:	  002E	78 00			mov r0, #00h
   34:	  0030	79 00			mov r1, #00h
   35:	  0032	11 3C			acall copy_rom_to_ram
   36:
   37:					;acall populate_ram
   38:
   39:	  0034			blink_loop:
   40:	  0034	11 5C			acall blink_led
   41:	  0036	11 95			acall delay_1_sec
   42:
   43:	  0038	80 FA			jmp blink_loop

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 2



 Line  I  Addr  Code            Source

   44:
   45:	  003A	80 C4			jmp 0000h
   46:
   47:	  003C			copy_rom_to_ram:
   48:	  003C	89 30			mov dptr_high, r1
   49:	  003E	88 31			mov dptr_low, r0
   50:
   51:	  0040			copy_loop:
   52:	  0040	85 30 83		mov dph, dptr_high
   53:	  0043	85 31 82		mov dpl, dptr_low
   54:
   55:	  0046	74 00			mov a, #00h
   56:	  0048	93			movc a, @a + dptr
   57:	  0049	F0			movx @dptr, a
   58:
   59:	  004A	05 31			inc dptr_low
   60:	  004C	E5 31			mov a, dptr_low
   61:	  004E	B4 00 EF		cjne a, #max_rom_address_low, copy_loop
   62:
   63:	  0051	05 30			inc dptr_high
   64:
   65:	  0053	E5 30			mov a, dptr_high
   66:
   67:	  0055	B4 80 E8		cjne a, #max_rom_address_high, copy_loop
   68:
   69:	  0058	75 F0 01		mov b, #01h
   70:
   71:	  005B	22			ret
   72:
   73:
   74:	  005C			blink_led:
   75:
   76:	  005C	B2 90		    cpl p1.0
   77:	  005E	B2 91			cpl p1.1
   78:	  0060	B2 92			cpl p1.2
   79:	  0062	B2 93			cpl p1.3
   80:	  0064	B2 94			cpl p1.4
   81:	  0066	B2 95			cpl p1.5
   82:	  0068	B2 96			cpl p1.6
   83:	  006A	B2 97			cpl p1.7
   84:
   85:	  006C			exit_blink_led:
   86:	  006C	22			ret
   87:
   88:
   89:	  006D			populate_ram:
   90:	  006D	75 30 00		mov dptr_high, #00h
   91:	  0070	75 31 00		mov dptr_low, #00h
   92:
   93:	  0073	75 F0 00		mov b, #00h
   94:
   95:	  0076			populate_loop:
   96:
   97:	  0076	85 30 83		mov dph, dptr_high
   98:	  0079	85 31 82		mov dpl, dptr_low
   99:

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 3



 Line  I  Addr  Code            Source

  100:	  007C	74 00			mov a, #00h
  101:
  102:	  007E	E5 F0			mov a, b
  103:	  0080	F0			movx @dptr, a
  104:	  0081	05 F0			inc b
  105:
  106:	  0083	05 31			inc dptr_low
  107:	  0085	E5 31			mov a, dptr_low
  108:
  109:	  0087	B4 00 EC		cjne a, #max_ram_address_low, populate_loop
  110:	  008A	05 30			inc dptr_high
  111:	  008C	E5 30			mov a, dptr_high
  112:
  113:	  008E	B4 80 E5		cjne a, #max_ram_address_high, populate_loop
  114:
  115:	  0091	75 F0 02		mov b, #02h
  116:
  117:	  0094	22			ret
  118:
  119:				$include (delay.asm)
  120: 1  0095			delay_1_sec:
  121: 1  0095	7A 64			mov r2, #0064h
  122: 1  0097			delay2:
  123: 1  0097	7C 64			mov r4, #0064h
  124: 1  0099			delay3:
  125: 1  0099	7B 28			mov r3, #0028h
  126: 1  009B			wait:
  127: 1  009B	DB FE			djnz r3, wait
  128: 1  009D	DC FA			djnz r4, delay3
  129: 1  009F	DA F6			djnz r2, delay2
  130: 1  00A1	22			ret
  131:
  132:				end
  133:





                     register banks used:  ---

                     no errors




ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 4





	       L I S T   O F   S Y M B O L S
	       =============================


SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
??ASEM_51			  NUMBER    8051
??VERSION			  NUMBER    0130
AC				  BIT	      D6
ACC				  DATA	      E0
B				  DATA	      F0
BLINK_LED			  CODE	    005C	  74
BLINK_LOOP			  CODE	    0034	  39
COPY_LOOP			  CODE	    0040	  51
COPY_ROM_TO_RAM			  CODE	    003C	  47
CY				  BIT	      D7
DELAY2				  CODE	    0097	 122
DELAY3				  CODE	    0099	 124
DELAY_1_SEC			  CODE	    0095	 120
DPH				  DATA	      83
DPL				  DATA	      82
DPTR_HIGH			  DATA	      30	   7
DPTR_LOW			  DATA	      31	   8
EA				  BIT	      AF
ES				  BIT	      AC
ET0				  BIT	      A9
ET1				  BIT	      AB
EX0				  BIT	      A8
EX1				  BIT	      AA
EXIT_BLINK_LED			  CODE	    006C	  85
EXTI0				  CODE	    0003
EXTI1				  CODE	    0013
F0				  BIT	      D5
IE				  DATA	      A8
IE0				  BIT	      89
IE1				  BIT	      8B
INT0				  BIT	      B2
INT1				  BIT	      B3
IP				  DATA	      B8
IT0				  BIT	      88
IT1				  BIT	      8A
MAIN				  CODE	    002B	  29
MAX_RAM_ADDRESS_HIGH		  NUMBER    0080	   3
MAX_RAM_ADDRESS_LOW		  NUMBER    0000	   4
MAX_ROM_ADDRESS_HIGH		  NUMBER    0080	   2
MAX_ROM_ADDRESS_LOW		  NUMBER    0000	   1
OV				  BIT	      D2
P				  BIT	      D0
P0				  DATA	      80
P1				  DATA	      90
P2				  DATA	      A0
P3				  DATA	      B0
PCON				  DATA	      87
POPULATE_LOOP			  CODE	    0076	  95
POPULATE_RAM			  CODE	    006D	  89
PS				  BIT	      BC

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 5



SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
PSW				  DATA	      D0
PT0				  BIT	      B9
PT1				  BIT	      BB
PX0				  BIT	      B8
PX1				  BIT	      BA
RB8				  BIT	      9A
RD				  BIT	      B7
REN				  BIT	      9C
RESET				  CODE	    0000
RI				  BIT	      98
RS0				  BIT	      D3
RS1				  BIT	      D4
RXD				  BIT	      B0
SBUF				  DATA	      99
SCON				  DATA	      98
SINT				  CODE	    0023
SM0				  BIT	      9F
SM1				  BIT	      9E
SM2				  BIT	      9D
SP				  DATA	      81
T0				  BIT	      B4
T1				  BIT	      B5
TB8				  BIT	      9B
TCON				  DATA	      88
TF0				  BIT	      8D
TF1				  BIT	      8F
TH0				  DATA	      8C
TH1				  DATA	      8D
TI				  BIT	      99
TIMER0				  CODE	    000B
TIMER1				  CODE	    001B
TL0				  DATA	      8A
TL1				  DATA	      8B
TMOD				  DATA	      89
TR0				  BIT	      8C
TR1				  BIT	      8E
TXD				  BIT	      B1
WAIT				  CODE	    009B	 126
WR				  BIT	      B6
